<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DAIMUZ - Finalizar Compra</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 600px;
            margin: 0 auto;
        }

        .back-btn {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            padding: 12px 24px;
            border-radius: 25px;
            text-decoration: none;
            font-weight: 600;
            margin-bottom: 20px;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .back-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateX(-5px);
        }

        .checkout-card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 25px;
            overflow: hidden;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            animation: fadeIn 0.5s ease-out;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .checkout-header {
            background: linear-gradient(135deg, #8e2de2 0%, #4a00e0 100%);
            padding: 25px;
            color: white;
            text-align: center;
        }

        .checkout-header h1 {
            font-size: 28px;
            margin-bottom: 5px;
        }

        .checkout-header p {
            opacity: 0.9;
            font-size: 14px;
        }

        .product-summary {
            background: linear-gradient(135deg, #f8f9fa 0%, #fff 100%);
            padding: 20px 25px;
            border-bottom: 2px solid #eee;
        }

        .product-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .product-img {
            width: 80px;
            height: 80px;
            border-radius: 12px;
            object-fit: cover;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .product-details h3 {
            color: #4a00e0;
            font-size: 18px;
            margin-bottom: 5px;
        }

        .product-price {
            color: #8e2de2;
            font-size: 22px;
            font-weight: bold;
        }

        .form-section {
            padding: 25px;
        }

        .section-title {
            color: #4a00e0;
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #eee;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .section-title::before {
            font-size: 18px;
        }

        .form-group {
            margin-bottom: 18px;
        }

        .form-group label {
            display: block;
            color: #333;
            font-weight: 600;
            margin-bottom: 8px;
            font-size: 14px;
        }

        .form-group label span {
            color: #e74c3c;
        }

        .form-control {
            width: 100%;
            padding: 14px 16px;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            font-size: 15px;
            transition: all 0.3s ease;
            background: #fff;
        }

        .form-control:focus {
            outline: none;
            border-color: #8e2de2;
            box-shadow: 0 0 0 3px rgba(142, 45, 226, 0.1);
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .color-options {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        .color-option {
            position: relative;
        }

        .color-option input {
            position: absolute;
            opacity: 0;
            cursor: pointer;
        }

        .color-option label {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 10px 15px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 13px;
        }

        .color-option input:checked + label {
            border-color: #8e2de2;
            background: linear-gradient(135deg, rgba(142, 45, 226, 0.1) 0%, rgba(74, 0, 224, 0.1) 100%);
        }

        .color-dot {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            border: 2px solid #ddd;
        }

        .quantity-selector {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .qty-btn {
            width: 45px;
            height: 45px;
            border: 2px solid #8e2de2;
            background: white;
            color: #8e2de2;
            font-size: 24px;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .qty-btn:hover {
            background: #8e2de2;
            color: white;
        }

        .qty-input {
            width: 70px;
            text-align: center;
            font-size: 20px;
            font-weight: bold;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            padding: 10px;
        }

        .option-toggle {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }

        .option-toggle input {
            display: none;
        }

        .option-toggle label {
            flex: 1;
            padding: 15px;
            text-align: center;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
        }

        .option-toggle input:checked + label {
            border-color: #8e2de2;
            background: linear-gradient(135deg, #8e2de2 0%, #4a00e0 100%);
            color: white;
        }

        .total-section {
            background: linear-gradient(135deg, #f8f9fa 0%, #fff 100%);
            padding: 20px 25px;
            border-top: 2px solid #eee;
        }

        .total-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .total-row.final {
            font-size: 20px;
            font-weight: bold;
            color: #4a00e0;
            padding-top: 10px;
            border-top: 2px dashed #ddd;
            margin-top: 10px;
        }

        .submit-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            width: 100%;
            background: linear-gradient(135deg, #8e2de2 0%, #4a00e0 100%);
            color: white;
            padding: 20px;
            border: none;
            border-radius: 15px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 6px 25px rgba(142, 45, 226, 0.4);
            margin-top: 20px;
        }

        .submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 30px rgba(142, 45, 226, 0.5);
        }

        .submit-btn.confirmar::before {
            content: "âœ…";
            font-size: 24px;
        }

        /* Modal de pedido */
        .order-modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 10000;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .order-modal-overlay.active {
            display: flex;
        }

        .order-modal {
            background: white;
            border-radius: 20px;
            max-width: 500px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            animation: modalSlideIn 0.3s ease-out;
        }

        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: translateY(-50px) scale(0.9);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .order-modal-header {
            background: linear-gradient(135deg, #8e2de2 0%, #4a00e0 100%);
            color: white;
            padding: 20px;
            text-align: center;
            border-radius: 20px 20px 0 0;
        }

        .order-modal-header h2 {
            margin: 0;
            font-size: 22px;
        }

        .order-modal-header p {
            margin: 5px 0 0;
            opacity: 0.9;
            font-size: 14px;
        }

        .order-modal-content {
            padding: 20px;
        }

        .order-info-box {
            background: #f8f9fa;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 15px;
            font-family: monospace;
            font-size: 13px;
            line-height: 1.6;
            white-space: pre-wrap;
            word-wrap: break-word;
            max-height: 300px;
            overflow-y: auto;
        }

        .order-modal-buttons {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .btn-copy {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            width: 100%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-copy:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }

        .btn-copy.copied {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
        }

        .btn-whatsapp-modal {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            width: 100%;
            background: linear-gradient(135deg, #25d366 0%, #128c7e 100%);
            color: white;
            padding: 15px;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 6px 25px rgba(37, 211, 102, 0.4);
        }

        .btn-whatsapp-modal:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 30px rgba(37, 211, 102, 0.5);
        }

        .btn-close-modal {
            background: transparent;
            border: 2px solid #e0e0e0;
            color: #666;
            padding: 12px;
            border-radius: 12px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-close-modal:hover {
            background: #f0f0f0;
        }

        .note {
            background: #fff3cd;
            border: 1px solid #ffc107;
            border-radius: 10px;
            padding: 12px 15px;
            font-size: 13px;
            color: #856404;
            margin-top: 15px;
        }

        .payment-steps {
            background: linear-gradient(135deg, #e8f4fd 0%, #d1ecf1 100%);
            border: 1px solid #bee5eb;
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 15px;
        }

        .payment-steps h4 {
            color: #0c5460;
            margin-bottom: 10px;
            font-size: 14px;
        }

        .payment-steps ol {
            margin: 0;
            padding-left: 20px;
            color: #0c5460;
            font-size: 13px;
        }

        .payment-steps li {
            margin-bottom: 5px;
        }

        .loading-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 9999;
            justify-content: center;
            align-items: center;
            flex-direction: column;
        }

        .loading-overlay.active {
            display: flex;
        }

        .loading-spinner {
            width: 60px;
            height: 60px;
            border: 5px solid rgba(255, 255, 255, 0.3);
            border-top-color: #fff;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .loading-text {
            color: white;
            margin-top: 20px;
            font-size: 18px;
            text-align: center;
        }

        .success-message {
            display: none;
            background: linear-gradient(135deg, #d4edda 0%, #c3e6cb 100%);
            border: 1px solid #28a745;
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            margin-bottom: 15px;
        }

        .success-message.active {
            display: block;
            animation: fadeIn 0.5s ease-out;
        }

        .success-message h3 {
            color: #155724;
            margin-bottom: 10px;
        }

        .success-message p {
            color: #155724;
            font-size: 14px;
        }

        .btn-group {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        @media (max-width: 480px) {
            body {
                padding: 10px;
            }

            .checkout-header {
                padding: 20px;
            }

            .checkout-header h1 {
                font-size: 24px;
            }

            .form-section {
                padding: 20px;
            }

            .form-row {
                grid-template-columns: 1fr;
            }

            .color-options {
                gap: 8px;
            }

            .color-option label {
                padding: 8px 12px;
                font-size: 12px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <a href="daimuz-catalog.html" class="back-btn">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                <path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/>
            </svg>
            Volver al CatÃ¡logo
        </a>

        <div class="checkout-card">
            <div class="checkout-header">
                <h1>ðŸ›’ Finalizar Compra</h1>
                <p>Completa tus datos para realizar el pedido</p>
            </div>

            <div class="product-summary">
                <div class="product-info">
                    <img id="productImg" class="product-img" src="" alt="Producto">
                    <div class="product-details">
                        <h3 id="productName">Nombre del Producto</h3>
                        <div class="product-price" id="productPrice">$0</div>
                    </div>
                </div>
            </div>

            <form id="checkoutForm">
                <div class="form-section">
                    <h3 class="section-title">ðŸŽ¨ Opciones del Producto</h3>
                    
                    <div class="form-group">
                        <label>Tipo de compra <span>*</span></label>
                        <div class="option-toggle">
                            <input type="radio" name="purchaseType" id="unitOnly" value="unidad" checked>
                            <label for="unitOnly">Solo Unidad</label>
                            <input type="radio" name="purchaseType" id="withCapsule" value="capsula">
                            <label for="withCapsule">Con CÃ¡psula</label>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Color <span>*</span></label>
                        <div class="color-options" id="colorOptions">
                            <div class="color-option">
                                <input type="radio" name="color" id="colorNegro" value="Negro" checked>
                                <label for="colorNegro">
                                    <span class="color-dot" style="background: #1a1a1a;"></span>
                                    Negro
                                </label>
                            </div>
                            <div class="color-option">
                                <input type="radio" name="color" id="colorBlanco" value="Blanco">
                                <label for="colorBlanco">
                                    <span class="color-dot" style="background: #fff; border-color: #ccc;"></span>
                                    Blanco
                                </label>
                            </div>
                            <div class="color-option">
                                <input type="radio" name="color" id="colorDorado" value="Dorado">
                                <label for="colorDorado">
                                    <span class="color-dot" style="background: linear-gradient(135deg, #f5d061 0%, #c9a227 100%);"></span>
                                    Dorado
                                </label>
                            </div>
                            <div class="color-option">
                                <input type="radio" name="color" id="colorPlata" value="Plata">
                                <label for="colorPlata">
                                    <span class="color-dot" style="background: linear-gradient(135deg, #e8e8e8 0%, #a8a8a8 100%);"></span>
                                    Plata
                                </label>
                            </div>
                            <div class="color-option">
                                <input type="radio" name="color" id="colorAzul" value="Azul">
                                <label for="colorAzul">
                                    <span class="color-dot" style="background: #2196F3;"></span>
                                    Azul
                                </label>
                            </div>
                            <div class="color-option">
                                <input type="radio" name="color" id="colorRojo" value="Rojo">
                                <label for="colorRojo">
                                    <span class="color-dot" style="background: #e74c3c;"></span>
                                    Rojo
                                </label>
                            </div>
                            <div class="color-option">
                                <input type="radio" name="color" id="colorVerde" value="Verde">
                                <label for="colorVerde">
                                    <span class="color-dot" style="background: #27ae60;"></span>
                                    Verde
                                </label>
                            </div>
                            <div class="color-option">
                                <input type="radio" name="color" id="colorMorado" value="Morado">
                                <label for="colorMorado">
                                    <span class="color-dot" style="background: #9b59b6;"></span>
                                    Morado
                                </label>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Cantidad <span>*</span></label>
                        <div class="quantity-selector">
                            <button type="button" class="qty-btn" onclick="changeQty(-1)">âˆ’</button>
                            <input type="number" id="quantity" class="qty-input" value="1" min="1" max="99" readonly>
                            <button type="button" class="qty-btn" onclick="changeQty(1)">+</button>
                        </div>
                    </div>
                </div>

                <div class="form-section">
                    <h3 class="section-title">ðŸ‘¤ Datos Personales</h3>
                    
                    <div class="form-group">
                        <label for="nombre">Nombre Completo <span>*</span></label>
                        <input type="text" id="nombre" class="form-control" placeholder="Ej: Juan PÃ©rez GarcÃ­a" required>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="cedula">CÃ©dula <span>*</span></label>
                            <input type="text" id="cedula" class="form-control" placeholder="Ej: 1234567890" required>
                        </div>
                        <div class="form-group">
                            <label for="celular">Celular <span>*</span></label>
                            <input type="tel" id="celular" class="form-control" placeholder="Ej: 3001234567" required>
                        </div>
                    </div>
                </div>

                <div class="form-section">
                    <h3 class="section-title">ðŸ“¦ Datos de EnvÃ­o</h3>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="departamento">Departamento <span>*</span></label>
                            <select id="departamento" class="form-control" required>
                                <option value="">Seleccionar...</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="ciudad">Ciudad/Municipio <span>*</span></label>
                            <select id="ciudad" class="form-control" required disabled>
                                <option value="">Primero seleccione departamento</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="direccion">DirecciÃ³n <span>*</span></label>
                        <input type="text" id="direccion" class="form-control" placeholder="Ej: Calle 123 #45-67, Apto 101" required>
                    </div>

                    <div class="form-group">
                        <label for="barrio">Barrio <span>*</span></label>
                        <input type="text" id="barrio" class="form-control" placeholder="Ej: Centro, La Candelaria" required>
                    </div>

                    <div class="note">
                        ðŸ“Œ <strong>Nota:</strong> Los envÃ­os se realizan Ãºnicamente dentro de Colombia. Tiempo de entrega: 1-3 dÃ­as hÃ¡biles (MedellÃ­n mismo dÃ­a).
                    </div>
                </div>

                <div class="total-section">
                    <div class="total-row">
                        <span>Subtotal:</span>
                        <span id="subtotal">$0</span>
                    </div>
                    <div class="total-row">
                        <span>Cantidad:</span>
                        <span id="qtyDisplay">1 unidad(es)</span>
                    </div>
                    <div class="total-row final">
                        <span>TOTAL:</span>
                        <span id="totalPrice">$0</span>
                    </div>
                </div>

                <div class="form-section" style="padding-top: 0;">
                    <div class="payment-steps">
                        <h4>ðŸ“‹ Proceso de compra:</h4>
                        <ol>
                            <li>Completa tus datos personales y de envÃ­o</li>
                            <li>Revisa tu pedido y haz clic en "Confirmar Pedido"</li>
                            <li>Copia la informaciÃ³n y continÃºa por WhatsApp</li>
                        </ol>
                    </div>

                    <div class="btn-group">
                        <button type="submit" class="submit-btn confirmar" id="confirmBtn">
                            Confirmar Pedido
                        </button>
                    </div>

                    <div class="note" style="margin-top: 15px;">
                        ðŸ’¡ <strong>Importante:</strong> Al confirmar, podrÃ¡s copiar tu pedido y enviarlo por WhatsApp para coordinar el pago y envÃ­o.
                    </div>
                </div>
            </form>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="loading-overlay">
        <div class="loading-spinner"></div>
        <div class="loading-text">Procesando tu pedido...</div>
    </div>

    <!-- Modal de InformaciÃ³n del Pedido -->
    <div id="orderModal" class="order-modal-overlay">
        <div class="order-modal">
            <div class="order-modal-header">
                <h2>âœ… Â¡Pedido Confirmado!</h2>
                <p>Copia la informaciÃ³n y envÃ­ala por WhatsApp</p>
            </div>
            <div class="order-modal-content">
                <div class="order-info-box" id="orderInfoText"></div>
                <div class="order-modal-buttons">
                    <button type="button" class="btn-copy" id="copyBtn">
                        ðŸ“‹ Copiar InformaciÃ³n del Pedido
                    </button>
                    <button type="button" class="btn-whatsapp-modal" id="whatsappModalBtn">
                        ðŸ“² Continuar en WhatsApp
                    </button>
                    <button type="button" class="btn-close-modal" id="closeModalBtn">
                        Cerrar
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Departamentos y Municipios de Colombia
        const colombiaData = {
            "Amazonas": ["Leticia", "Puerto NariÃ±o", "El Encanto", "La Chorrera", "La Pedrera", "La Victoria", "MiritÃ­ ParanÃ¡", "Puerto AlegrÃ­a", "Puerto Arica", "Puerto Santander", "TarapacÃ¡"],
            "Antioquia": ["MedellÃ­n", "Bello", "ItagÃ¼Ã­", "Envigado", "ApartadÃ³", "Turbo", "Rionegro", "Caucasia", "Copacabana", "La Estrella", "Sabaneta", "Caldas", "Girardota", "Barbosa", "Marinilla", "El Carmen de Viboral", "La Ceja", "El Retiro", "Guarne", "El Santuario", "Puerto BerrÃ­o", "Yarumal", "Santa Rosa de Osos", "Cisneros", "Segovia", "Remedios", "Amalfi", "Andes", "JardÃ­n", "Ciudad BolÃ­var", "Urrao", "Santa Fe de Antioquia", "SopetrÃ¡n", "San JerÃ³nimo", "Fredonia", "JericÃ³", "TÃ¡mesis", "La Pintada", "Venecia", "Caramanta", "ValparaÃ­so", "NecoclÃ­", "San Pedro de UrabÃ¡", "Arboletes", "San Juan de UrabÃ¡", "ChigorodÃ³", "Carepa", "MutatÃ¡", "Dabeiba", "Frontino", "Peque", "Uramita", "CaÃ±asgordas", "AbriaquÃ­", "Giraldo", "BuriticÃ¡", "Liborina", "Sabanalarga", "San AndrÃ©s de Cuerquia", "Toledo", "BriceÃ±o", "Ituango", "San JosÃ© de la MontaÃ±a", "Valdivia", "TarazÃ¡", "CÃ¡ceres", "El Bagre", "Zaragoza", "NechÃ­", "YondÃ³", "Puerto Triunfo", "SonsÃ³n", "Argelia", "NariÃ±o", "Abejorral", "ConcepciÃ³n", "AlejandrÃ­a", "San Rafael", "San Carlos", "Granada", "San Luis", "CocornÃ¡", "San Francisco", "Santo Domingo", "VegachÃ­", "YalÃ­", "YolombÃ³", "GÃ³mez Plata", "Guadalupe", "Carolina del PrÃ­ncipe", "Santa Rosa de Osos", "DonmatÃ­as", "EntrerrÃ­os", "San Pedro de los Milagros", "Belmira"],
            "Arauca": ["Arauca", "Arauquita", "Cravo Norte", "Fortul", "Puerto RondÃ³n", "Saravena", "Tame"],
            "AtlÃ¡ntico": ["Barranquilla", "Soledad", "Malambo", "Sabanalarga", "Baranoa", "Puerto Colombia", "Galapa", "Palmar de Varela", "Santo TomÃ¡s", "Polonuevo", "Ponedera", "Sabanagrande", "Candelaria", "Campo de la Cruz", "ManatÃ­", "RepelÃ³n", "Santa LucÃ­a", "Suan", "TubarÃ¡", "UsiacurÃ­", "Juan de Acosta", "PiojÃ³", "Luruaco"],
            "BogotÃ¡ D.C.": ["BogotÃ¡"],
            "BolÃ­var": ["Cartagena", "MaganguÃ©", "Turbaco", "Arjona", "El Carmen de BolÃ­var", "San Juan Nepomuceno", "MarÃ­a la Baja", "MompÃ³s", "SimitÃ­", "San Pablo", "Santa Rosa del Sur", "Morales", "AchÃ­", "Altos del Rosario", "Arenal", "Barranco de Loba", "Calamar", "Cantagallo", "Cicuco", "Clemencia", "CÃ³rdoba", "El Guamo", "El PeÃ±Ã³n", "Hatillo de Loba", "Margarita", "Montecristo", "NorosÃ­", "Pinillos", "Regidor", "RÃ­o Viejo", "San CristÃ³bal", "San Estanislao", "San Fernando", "San Jacinto", "San Jacinto del Cauca", "San MartÃ­n de Loba", "Santa Catalina", "Santa Rosa", "Soplaviento", "Talaigua Nuevo", "Tiquisio", "Villanueva", "Zambrano"],
            "BoyacÃ¡": ["Tunja", "Duitama", "Sogamoso", "ChiquinquirÃ¡", "Paipa", "Puerto BoyacÃ¡", "Villa de Leyva", "MoniquirÃ¡", "Garagoa", "Miraflores", "Nobsa", "Tibasosa", "Firavitoba", "Iza", "CuÃ­tiva", "Tota", "Pesca", "Aquitania", "Tota", "Zetaquira", "Berbeo", "San Eduardo", "Macanal", "Santa MarÃ­a", "Campohermoso", "PÃ¡ez", "Chita", "JericÃ³", "SocotÃ¡", "Socha", "Tasco", "Paz de RÃ­o", "BetÃ©itiva", "BusbanzÃ¡", "Corrales", "Floresta", "TutazÃ¡", "BelÃ©n", "Cerinza", "Santa Rosa de Viterbo", "Sativanorte", "Sativasur", "SusacÃ³n", "Tipacoque", "CovarachÃ­a", "Boavita", "La Uvita", "San Mateo", "Guacamayas", "El Cocuy", "GÃ¼icÃ¡n", "Panqueba", "El Espino", "CubarÃ¡", "Labranzagrande", "Paya", "Pisba", "Mongua", "GÃ¡meza", "TÃ³paga", "MonguÃ­", "RÃ¡quira", "SutamarchÃ¡n", "TinjacÃ¡", "SaboyÃ¡", "San Miguel de Sema", "Caldas", "Buenavista", "Coper", "La Victoria", "MaripÃ­", "Muzo", "Otanche", "Pauna", "QuÃ­pama", "San Pablo de Borbur", "TununguÃ¡", "BriceÃ±o", "Tunungua", "Maripi"],
            "Caldas": ["Manizales", "La Dorada", "ChinchinÃ¡", "VillamarÃ­a", "Riosucio", "Anserma", "SupÃ­a", "Aguadas", "PÃ¡cora", "Salamina", "Aranzazu", "Filadelfia", "La Merced", "Marmato", "Neira", "Palestina", "Pensilvania", "Manzanares", "Marquetalia", "Marulanda", "SamanÃ¡", "Victoria", "BelalcÃ¡zar", "Risaralda", "San JosÃ©", "Viterbo", "Norcasia"],
            "CaquetÃ¡": ["Florencia", "San Vicente del CaguÃ¡n", "Puerto Rico", "El Doncello", "El Paujil", "Cartagena del ChairÃ¡", "MontaÃ±ita", "BelÃ©n de los AndaquÃ­es", "Albania", "Curillo", "MilÃ¡n", "Morelia", "San JosÃ© del Fragua", "Solano", "Solita", "ValparaÃ­so"],
            "Casanare": ["Yopal", "Aguazul", "Villanueva", "Tauramena", "Paz de Ariporo", "Pore", "Trinidad", "San Luis de Palenque", "OrocuÃ©", "NunchÃ­a", "Hato Corozal", "TÃ¡mara", "Monterrey", "Sabanalarga", "Recetor", "ChÃ¡meza", "La Salina", "SÃ¡cama", "ManÃ­"],
            "Cauca": ["PopayÃ¡n", "Santander de Quilichao", "Puerto Tejada", "PatÃ­a", "PiendamÃ³", "CajibÃ­o", "Silvia", "TimbÃ­o", "BolÃ­var", "Miranda", "Corinto", "Caloto", "GuachenÃ©", "Villarrica", "Padilla", "Buenos Aires", "SuÃ¡rez", "Morales", "El Tambo", "Argelia", "Balboa", "Mercaderes", "Florencia", "La Sierra", "La Vega", "Almaguer", "San SebastiÃ¡n", "Santa Rosa", "Rosas", "SotarÃ¡", "PuracÃ©", "TotorÃ³", "InzÃ¡", "PÃ¡ez", "JambalÃ³", "ToribÃ­o", "Caldono", "LÃ³pez de Micay", "TimbiquÃ­", "Guapi"],
            "Cesar": ["Valledupar", "Aguachica", "AgustÃ­n Codazzi", "Bosconia", "Chimichagua", "ChiriguanÃ¡", "CurumanÃ­", "El Copey", "El Paso", "Gamarra", "GonzÃ¡lez", "La Gloria", "La Jagua de Ibirico", "La Paz", "Manaure BalcÃ³n del Cesar", "Pailitas", "Pelaya", "Pueblo Bello", "RÃ­o de Oro", "San Alberto", "San Diego", "San MartÃ­n", "Tamalameque"],
            "ChocÃ³": ["QuibdÃ³", "Istmina", "TadÃ³", "Condoto", "BahÃ­a Solano", "NuquÃ­", "AcandÃ­", "UnguÃ­a", "Riosucio", "Carmen del DariÃ©n", "BojayÃ¡", "Medio Atrato", "Atrato", "LlorÃ³", "BagadÃ³", "CerteguÃ­", "UniÃ³n Panamericana", "CÃ©rtegui", "CantÃ³n de San Pablo", "Medio BaudÃ³", "Bajo BaudÃ³", "Litoral del San Juan", "SipÃ­", "NÃ³vita", "San JosÃ© del Palmar", "El Carmen de Atrato", "El Litoral del San Juan", "JuradÃ³", "Alto BaudÃ³", "Medio San Juan", "RÃ­o IrÃ³", "RÃ­o Quito"],
            "CÃ³rdoba": ["MonterÃ­a", "CeretÃ©", "SahagÃºn", "Lorica", "MontelÃ­bano", "Planeta Rica", "Tierralta", "CiÃ©naga de Oro", "San AndrÃ©s de Sotavento", "San Pelayo", "San Carlos", "ChinÃº", "Puerto Escondido", "MoÃ±itos", "Los CÃ³rdobas", "Canalete", "Valencia", "Pueblo Nuevo", "La Apartada", "Buenavista", "Ayapel", "San Bernardo del Viento", "PurÃ­sima", "Momil", "ChimÃ¡", "Cotorra", "San Antero", "TuchÃ­n"],
            "Cundinamarca": ["Soacha", "FacatativÃ¡", "ZipaquirÃ¡", "ChÃ­a", "FusagasugÃ¡", "Girardot", "Madrid", "Mosquera", "Funza", "CajicÃ¡", "SibatÃ©", "TocancipÃ¡", "SopÃ³", "La Calera", "Cota", "Tabio", "Tenjo", "Subachoque", "El Rosal", "BojacÃ¡", "ZipacÃ³n", "Cachipay", "Anolaima", "La Mesa", "Anapoima", "Apulo", "ViotÃ¡", "Tocaima", "Agua de Dios", "Ricaurte", "Nilo", "JerusalÃ©n", "GuataquÃ­", "BeltrÃ¡n", "PulÃ­", "San Juan de Rioseco", "ChaguanÃ­", "Guayabal de SÃ­quima", "Bituima", "VianÃ­", "AlbÃ¡n", "Sasaima", "Villeta", "Ãštica", "Quebradanegra", "Nimaima", "Nocaima", "Vergara", "La Palma", "YacopÃ­", "CaparrapÃ­", "El PeÃ±Ã³n", "TopaipÃ­", "Paime", "VillagÃ³mez", "San Cayetano", "Puerto Salgar", "Guaduas", "SupatÃ¡", "Carmen de Carupa", "CucunubÃ¡", "FÃºquene", "GuachetÃ¡", "Lenguazaque", "Simijaca", "Susa", "Sutatausa", "Tausa", "UbatÃ©", "NemocÃ³n", "Cogua", "GachancipÃ¡", "Suesca", "SesquilÃ©", "ChocontÃ¡", "VillapinzÃ³n", "TibiritÃ¡", "MachetÃ¡", "Manta", "Guatavita", "Guasca", "JunÃ­n", "GachalÃ¡", "UbalÃ¡", "Gama", "GachetÃ¡", "Medina", "Paratebueno", "La Vega", "San Francisco", "Fosca", "GutiÃ©rrez", "Une", "Chipaque", "CÃ¡queza", "Ubaque", "ChoachÃ­", "FÃ³meque", "Quetame", "Guayabetal", "ArbelÃ¡ez", "San Bernardo", "Pandi", "Venecia", "Cabrera", "Pasca", "Silvania", "Granada", "Tibacuy"],
            "GuainÃ­a": ["InÃ­rida", "Barranco Minas", "Mapiripana", "San Felipe", "Puerto Colombia", "La Guadalupe", "Cacahual", "Pana Pana", "Morichal"],
            "Guaviare": ["San JosÃ© del Guaviare", "Calamar", "El Retorno", "Miraflores"],
            "Huila": ["Neiva", "Pitalito", "GarzÃ³n", "La Plata", "Campoalegre", "Palermo", "Algeciras", "Colombia", "Rivera", "Aipe", "Villavieja", "Tello", "Baraya", "YaguarÃ¡", "Hobo", "Gigante", "Agrado", "Altamira", "Guadalupe", "Suaza", "Acevedo", "TimanÃ¡", "ElÃ­as", "Oporapa", "Saladoblanco", "Isnos", "San AgustÃ­n", "Palestina", "Pital", "Tesalia", "Paicol", "NÃ¡taga", "Ãquira", "Teruel", "Santa MarÃ­a", "Tarqui"],
            "La Guajira": ["Riohacha", "Maicao", "Uribia", "Manaure", "San Juan del Cesar", "Fonseca", "Barrancas", "Villanueva", "El Molino", "Urumita", "La Jagua del Pilar", "Hatonuevo", "Albania", "DistracciÃ³n", "Dibulla"],
            "Magdalena": ["Santa Marta", "CiÃ©naga", "FundaciÃ³n", "El Banco", "Plato", "Aracataca", "Pivijay", "Zona Bananera", "El RetÃ©n", "Algarrobo", "AriguanÃ­", "Cerro de San Antonio", "Chibolo", "Concordia", "El PiÃ±Ã³n", "Guamal", "Nueva Granada", "Pedraza", "PijiÃ±o del Carmen", "Puebloviejo", "Remolino", "Sabanas de San Ãngel", "Salamina", "San SebastiÃ¡n de Buenavista", "San ZenÃ³n", "Santa Ana", "Santa BÃ¡rbara de Pinto", "Sitionuevo", "Tenerife", "ZapayÃ¡n"],
            "Meta": ["Villavicencio", "AcacÃ­as", "Granada", "Puerto LÃ³pez", "San MartÃ­n", "Cumaral", "Restrepo", "Puerto GaitÃ¡n", "Guamal", "Castilla la Nueva", "San Carlos de Guaroa", "Barranca de UpÃ­a", "Cabuyaro", "Puerto Lleras", "Puerto Rico", "Vista Hermosa", "San Juan de Arama", "Mesetas", "LejanÃ­as", "El Castillo", "El Dorado", "Uribe", "La Macarena", "MapiripÃ¡n", "Puerto Concordia", "La Uribe", "El Calvario", "San Juanito", "Fuente de Oro"],
            "NariÃ±o": ["Pasto", "Tumaco", "Ipiales", "TÃºquerres", "La UniÃ³n", "Samaniego", "SandonÃ¡", "Barbacoas", "El Charco", "Olaya Herrera", "La Tola", "MagÃ¼Ã­ PayÃ¡n", "Roberto PayÃ¡n", "Francisco Pizarro", "Mosquera", "Santa BÃ¡rbara", "Cumbitara", "Policarpa", "Los Andes", "El Rosario", "Leiva", "El Tambo", "Taminango", "San Lorenzo", "Arboleda", "San Pedro de Cartago", "AlbÃ¡n", "Buesaco", "ChachagÃ¼Ã­", "El TablÃ³n de GÃ³mez", "La Florida", "NariÃ±o", "Tangua", "Yacuanquer", "ConsacÃ¡", "Ancuya", "Linares", "La Llanada", "Sotomayor", "Santacruz", "Sapuyes", "Ospina", "Iles", "GualmatÃ¡n", "Contadero", "CÃ³rdoba", "Puerres", "Funes", "PotosÃ­", "Cuaspud Carlosama", "Aldana", "Guachucal", "Cumbal", "Mallama", "Ricaurte"],
            "Norte de Santander": ["CÃºcuta", "OcaÃ±a", "Pamplona", "Villa del Rosario", "Los Patios", "TibÃº", "El Zulia", "Puerto Santander", "San Cayetano", "Sardinata", "Abrego", "La Playa", "HacarÃ­", "San Calixto", "Teorama", "ConvenciÃ³n", "El Carmen", "El Tarra", "Bucarasica", "Lourdes", "Gramalote", "Santiago", "Villacaro", "Salazar", "Arboledas", "Cucutilla", "Durania", "Bochalema", "ChinÃ¡cota", "Ragonvalia", "HerrÃ¡n", "Toledo", "Labateca", "ChitagÃ¡", "Silos", "CÃ¡cota", "Mutiscua", "Pamplonita", "CÃ¡chira", "La Esperanza", "Ãbrego"],
            "Putumayo": ["Mocoa", "Puerto AsÃ­s", "Orito", "Valle del Guamuez", "VillagarzÃ³n", "Puerto GuzmÃ¡n", "Puerto Caicedo", "San Miguel", "Puerto LeguÃ­zamo", "Sibundoy", "ColÃ³n", "Santiago", "San Francisco"],
            "QuindÃ­o": ["Armenia", "CalarcÃ¡", "Montenegro", "Quimbaya", "La Tebaida", "Circasia", "Filandia", "Salento", "GÃ©nova", "Pijao", "Buenavista", "CÃ³rdoba"],
            "Risaralda": ["Pereira", "Dosquebradas", "Santa Rosa de Cabal", "La Virginia", "Marsella", "BelÃ©n de UmbrÃ­a", "ApÃ­a", "Santuario", "QuinchÃ­a", "GuÃ¡tica", "MistratÃ³", "Pueblo Rico", "Balboa", "La Celia"],
            "San AndrÃ©s y Providencia": ["San AndrÃ©s", "Providencia"],
            "Santander": ["Bucaramanga", "Floridablanca", "GirÃ³n", "Piedecuesta", "Barrancabermeja", "San Gil", "Socorro", "VÃ©lez", "Barbosa", "Puerto Wilches", "Cimitarra", "MÃ¡laga", "CharalÃ¡", "Oiba", "CuritÃ­", "Aratoca", "Villanueva", "Barichara", "Cabrera", "Palmas del Socorro", "GuapotÃ¡", "ContrataciÃ³n", "El Guacamayo", "GalÃ¡n", "Gambita", "Guadalupe", "GuavatÃ¡", "Hato", "JesÃºs MarÃ­a", "La Paz", "Puente Nacional", "Suaita", "Sucre", "Zapatoca", "Los Santos", "JordÃ¡n", "CepitÃ¡", "San JoaquÃ­n", "Onzaga", "Mogotes", "Ocamonte", "PÃ¡ramo", "San JosÃ© de Miranda", "Enciso", "Capitanejo", "San Miguel", "CarcasÃ­", "Macaravita", "ConcepciÃ³n", "Cerrito", "Molagavita", "Guaca", "San AndrÃ©s", "Tona", "Charta", "California", "Vetas", "SuratÃ¡", "Matanza", "El PlayÃ³n", "Rionegro", "Lebrija", "Sabana de Torres", "Puerto Parra", "Simacota", "El Carmen de ChucurÃ­", "San Vicente de ChucurÃ­", "Betulia", "LandÃ¡zuri", "BolÃ­var", "El PeÃ±Ã³n", "La Belleza", "FloriÃ¡n", "Albania", "Aguada", "San Benito", "La Paz", "GÃ¼epsa", "Barbosa", "ChipatÃ¡", "San JosÃ© de Pare", "MoniquirÃ¡", "TogÃ¼Ã­", "Santana", "Cimitarra"],
            "Sucre": ["Sincelejo", "Corozal", "San Marcos", "SampuÃ©s", "TolÃº", "San Onofre", "SincÃ©", "Majagual", "Sucre", "Ovejas", "Los Palmitos", "Morroa", "ChalÃ¡n", "Coloso", "Galeras", "El Roble", "San Pedro", "Buenavista", "CoveÃ±as", "Toluviejo", "San Antonio de Palmito", "Guaranda", "La UniÃ³n", "Caimito", "San Benito Abad"],
            "Tolima": ["IbaguÃ©", "Espinal", "Melgar", "Chaparral", "Honda", "Mariquita", "LÃ­bano", "Fresno", "Guamo", "PurificaciÃ³n", "SaldaÃ±a", "LÃ©rida", "Venadillo", "Piedras", "Coello", "Flandes", "San Luis", "SuÃ¡rez", "Carmen de ApicalÃ¡", "Cunday", "Villarrica", "Dolores", "Alpujarra", "Prado", "Natagaima", "Coyaima", "Ortega", "San Antonio", "Rovira", "Valle de San Juan", "Roncesvalles", "San JosÃ©", "Cajamarca", "AnzoÃ¡tegui", "Santa Isabel", "Murillo", "Villahermosa", "Casabianca", "Herveo", "Palocabildo", "FÃ¡lan", "Ambalema", "Armero", "Alvarado", "Piedras", "Icononzo", "Planadas", "Rioblanco", "Ataco"],
            "Valle del Cauca": ["Cali", "Buenaventura", "Palmira", "TuluÃ¡", "Buga", "Cartago", "Yumbo", "JamundÃ­", "Candelaria", "Florida", "Pradera", "Zarzal", "Roldanillo", "Sevilla", "Caicedonia", "La UniÃ³n", "Trujillo", "Bugalagrande", "AndalucÃ­a", "San Pedro", "GuacarÃ­", "Ginebra", "El Cerrito", "Dagua", "La Cumbre", "Restrepo", "Vijes", "Yotoco", "RiofrÃ­o", "BolÃ­var", "Versalles", "El Dovio", "Argelia", "El Cairo", "Ansermanuevo", "El Ãguila", "Ulloa", "AlcalÃ¡", "Obando", "La Victoria", "Toro", "Calima El DariÃ©n"],
            "VaupÃ©s": ["MitÃº", "CarurÃº", "Taraira", "Papunaua", "YavaratÃ©", "Pacoa"],
            "Vichada": ["Puerto CarreÃ±o", "La Primavera", "Santa RosalÃ­a", "Cumaribo"]
        };

        // Product data from URL parameters
        const urlParams = new URLSearchParams(window.location.search);
        const productName = urlParams.get('product') || 'Producto';
        const productPrice = parseInt(urlParams.get('price')) || 0;
        const productPriceCapsule = parseInt(urlParams.get('priceCapsule')) || 0;
        const productImage = urlParams.get('image') || '';

        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            // Set product info
            document.getElementById('productName').textContent = productName;
            document.getElementById('productPrice').textContent = formatPrice(productPrice);
            document.getElementById('productImg').src = productImage;
            
            // Populate departments
            const deptSelect = document.getElementById('departamento');
            Object.keys(colombiaData).sort().forEach(dept => {
                const option = document.createElement('option');
                option.value = dept;
                option.textContent = dept;
                deptSelect.appendChild(option);
            });

            // Department change handler
            deptSelect.addEventListener('change', function() {
                const citySelect = document.getElementById('ciudad');
                citySelect.innerHTML = '<option value="">Seleccionar...</option>';
                
                if (this.value) {
                    citySelect.disabled = false;
                    colombiaData[this.value].sort().forEach(city => {
                        const option = document.createElement('option');
                        option.value = city;
                        option.textContent = city;
                        citySelect.appendChild(option);
                    });
                } else {
                    citySelect.disabled = true;
                }
            });

            // Update totals
            updateTotals();

            // Purchase type change
            document.querySelectorAll('input[name="purchaseType"]').forEach(radio => {
                radio.addEventListener('change', updateTotals);
            });
        });

        function formatPrice(price) {
            return '$' + price.toLocaleString('es-CO');
        }

        function changeQty(delta) {
            const input = document.getElementById('quantity');
            let value = parseInt(input.value) + delta;
            if (value < 1) value = 1;
            if (value > 99) value = 99;
            input.value = value;
            updateTotals();
        }

        function updateTotals() {
            const qty = parseInt(document.getElementById('quantity').value);
            const isWithCapsule = document.getElementById('withCapsule').checked;
            const unitPrice = isWithCapsule ? productPriceCapsule : productPrice;
            const total = unitPrice * qty;

            document.getElementById('subtotal').textContent = formatPrice(unitPrice);
            document.getElementById('qtyDisplay').textContent = qty + ' unidad(es)';
            document.getElementById('totalPrice').textContent = formatPrice(total);
            document.getElementById('noteTotal').textContent = formatPrice(total);
            document.getElementById('productPrice').textContent = formatPrice(unitPrice) + (isWithCapsule ? ' (con cÃ¡psula)' : '');
        }

        // Store order data
        let currentOrderData = null;

        // Build order text for copying
        function buildOrderText(orderData) {
            return `ðŸ›’ PEDIDO DAIMUZ
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ðŸ“¦ PRODUCTO:
â€¢ ${orderData.productName}
â€¢ Tipo: ${orderData.purchaseType === 'capsula' ? 'Con CÃ¡psula' : 'Solo Unidad'}
â€¢ Color: ${orderData.color}
â€¢ Cantidad: ${orderData.qty}
â€¢ Precio unitario: ${formatPrice(orderData.unitPrice)}
â€¢ TOTAL: ${formatPrice(orderData.total)}

ðŸ‘¤ DATOS DEL CLIENTE:
â€¢ Nombre: ${orderData.nombre}
â€¢ CÃ©dula: ${orderData.cedula}
â€¢ Celular: ${orderData.celular}

ðŸ“ DATOS DE ENVÃO:
â€¢ Departamento: ${orderData.departamento}
â€¢ Ciudad: ${orderData.ciudad}
â€¢ DirecciÃ³n: ${orderData.direccion}
â€¢ Barrio: ${orderData.barrio}

ðŸ“… Fecha: ${new Date().toLocaleString('es-CO')}

Â¡Pendiente! `;
        }

        // Build WhatsApp message
        function buildWhatsAppMessage(orderData) {
            return `ðŸ›’ *NUEVO PEDIDO DAIMUZ*

ðŸ“¦ *PRODUCTO:*
â€¢ ${orderData.productName}
â€¢ Tipo: ${orderData.purchaseType === 'capsula' ? 'Con CÃ¡psula' : 'Solo Unidad'}
â€¢ Color: ${orderData.color}
â€¢ Cantidad: ${orderData.qty}
â€¢ Precio unitario: ${formatPrice(orderData.unitPrice)}
â€¢ *TOTAL: ${formatPrice(orderData.total)}*

ðŸ‘¤ *DATOS DEL CLIENTE:*
â€¢ Nombre: ${orderData.nombre}
â€¢ CÃ©dula: ${orderData.cedula}
â€¢ Celular: ${orderData.celular}

ðŸ“ *DATOS DE ENVÃO:*
â€¢ Departamento: ${orderData.departamento}
â€¢ Ciudad: ${orderData.ciudad}
â€¢ DirecciÃ³n: ${orderData.direccion}
â€¢ Barrio: ${orderData.barrio}

Â¡!Pendiente`;
        }

        // Show order modal
        function showOrderModal(orderData) {
            const orderText = buildOrderText(orderData);
            document.getElementById('orderInfoText').textContent = orderText;
            document.getElementById('orderModal').classList.add('active');
        }

        // Hide order modal
        function hideOrderModal() {
            document.getElementById('orderModal').classList.remove('active');
        }

        // Copy to clipboard
        async function copyOrderToClipboard() {
            const orderText = document.getElementById('orderInfoText').textContent;
            try {
                await navigator.clipboard.writeText(orderText);
                const copyBtn = document.getElementById('copyBtn');
                copyBtn.innerHTML = 'âœ… Â¡Copiado!';
                copyBtn.classList.add('copied');
                setTimeout(() => {
                    copyBtn.innerHTML = 'ðŸ“‹ Copiar InformaciÃ³n del Pedido';
                    copyBtn.classList.remove('copied');
                }, 2000);
            } catch (err) {
                // Fallback for older browsers
                const textArea = document.createElement('textarea');
                textArea.value = orderText;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                const copyBtn = document.getElementById('copyBtn');
                copyBtn.innerHTML = 'âœ… Â¡Copiado!';
                copyBtn.classList.add('copied');
                setTimeout(() => {
                    copyBtn.innerHTML = 'ðŸ“‹ Copiar InformaciÃ³n del Pedido';
                    copyBtn.classList.remove('copied');
                }, 2000);
            }
        }

        // Form submission
        document.getElementById('checkoutForm').addEventListener('submit', async function(e) {
            e.preventDefault();

            // Gather form data
            const qty = parseInt(document.getElementById('quantity').value);
            const purchaseType = document.querySelector('input[name="purchaseType"]:checked').value;
            const color = document.querySelector('input[name="color"]:checked').value;
            const nombre = document.getElementById('nombre').value;
            const cedula = document.getElementById('cedula').value;
            const celular = document.getElementById('celular').value;
            const departamento = document.getElementById('departamento').value;
            const ciudad = document.getElementById('ciudad').value;
            const direccion = document.getElementById('direccion').value;
            const barrio = document.getElementById('barrio').value;

            const isWithCapsule = purchaseType === 'capsula';
            const unitPrice = isWithCapsule ? productPriceCapsule : productPrice;
            const total = unitPrice * qty;

            // Store order data
            currentOrderData = {
                productName,
                purchaseType,
                color,
                qty,
                unitPrice,
                total,
                nombre,
                cedula,
                celular,
                departamento,
                ciudad,
                direccion,
                barrio,
                fecha: new Date().toISOString()
            };

            // Show loading briefly
            document.getElementById('loadingOverlay').classList.add('active');
            
            setTimeout(() => {
                document.getElementById('loadingOverlay').classList.remove('active');
                // Show order modal
                showOrderModal(currentOrderData);
            }, 500);
        });

        // Copy button event
        document.getElementById('copyBtn').addEventListener('click', copyOrderToClipboard);

        // WhatsApp button in modal
        document.getElementById('whatsappModalBtn').addEventListener('click', function() {
            if (currentOrderData) {
                const message = buildWhatsAppMessage(currentOrderData);
                const encodedMessage = encodeURIComponent(message);
                window.open(`https://wa.me/message/56AISNOZMVW5N1?text=${encodedMessage}`, '_blank');
            }
        });

        // Close modal button
        document.getElementById('closeModalBtn').addEventListener('click', hideOrderModal);

        // Close modal when clicking outside
        document.getElementById('orderModal').addEventListener('click', function(e) {
            if (e.target === this) {
                hideOrderModal();
            }
        });
    </script>
</body>
</html>
